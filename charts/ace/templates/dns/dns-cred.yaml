{{- if not (eq .Values.global.infra.dns.provider "external") }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ace.fullname" . }}-dns-cred
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "ace.labels" . | nindent 4 }}
type: Opaque
stringData:
{{- if eq .Values.global.infra.dns.provider "cloudflare" }}
  CF_API_TOKEN: '{{ .Values.global.infra.dns.auth.cloudflare.token }}'
{{- end }}
{{- if eq .Values.global.infra.dns.provider "route53" }}
  AWS_ACCESS_KEY_ID: '{{ .Values.global.infra.dns.auth.route53.AWS_ACCESS_KEY_ID }}'
  AWS_SECRET_ACCESS_KEY: '{{ .Values.global.infra.dns.auth.route53.AWS_SECRET_ACCESS_KEY }}'
  AWS_REGION: '{{ .Values.global.infra.dns.auth.route53.AWS_REGION }}'
  # https://github.com/kubeops/external-dns-operator/blob/master/examples/aws-credential.md
  AWS_CREDENTIAL_FILE: |
    [default]
    aws_access_key_id = {{ .Values.global.infra.dns.auth.route53.AWS_ACCESS_KEY_ID }}
    aws_secret_access_key = {{ .Values.global.infra.dns.auth.route53.AWS_SECRET_ACCESS_KEY }}
{{- end }}
{{- if eq .Values.global.infra.dns.provider "cloudDNS" }}
  GOOGLE_SERVICE_ACCOUNT_JSON_KEY: '{{ .Values.global.infra.dns.auth.cloudDNS.GOOGLE_SERVICE_ACCOUNT_JSON_KEY }}'
{{- end }}
{{- end }}

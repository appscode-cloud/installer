apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ace.fullname" . }}-backup-repo-cred
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "ace.labels" . | nindent 4 }}
type: Opaque
stringData:
  RESTIC_PASSWORD: {{ .Values.global.infra.stash.backupPassword | quote }}
{{- if eq .Values.global.infra.objstore.provider "gcs" }}
  GOOGLE_SERVICE_ACCOUNT_JSON_KEY: '{{ .Values.global.infra.objstore.auth.GOOGLE_SERVICE_ACCOUNT_JSON_KEY }}'
  {{- with .Values.global.infra.objstore.auth.GOOGLE_PROJECT_ID }}
  GOOGLE_PROJECT_ID: '{{ . }}'
  {{- end }}
{{- end }}
{{- if eq .Values.global.infra.objstore.provider "s3" }}
  AWS_ACCESS_KEY_ID: '{{ .Values.global.infra.objstore.auth.AWS_ACCESS_KEY_ID }}'
  AWS_SECRET_ACCESS_KEY: '{{ .Values.global.infra.objstore.auth.AWS_SECRET_ACCESS_KEY }}'
  {{- with .Values.global.infra.objstore.auth.CA_CERT_DATA }}
  CA_CERT_DATA: '{{ . }}'
  {{- end }}
{{- end }}
